var device_logs = [
    {
        "device-id": 101,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 102,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 103,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 104,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 105,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 106,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 107,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 108,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 109,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 110,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 111,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 112,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 113,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 114,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 115,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 116,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 117,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 118,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 119,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 120,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 121,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 122,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 123,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 124,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 125,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 126,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 127,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 128,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 129,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 130,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 131,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 132,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 133,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 134,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 135,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 136,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 137,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 138,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 139,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 140,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 141,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 142,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 143,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 144,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 145,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 146,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 147,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
    {
        "device-id": 148,
        "name": "Selling Fan",
        "action": "Turn Off",
        "date": "124518"
    },
    {
        "device-id": 149,
        "name": "TV",
        "action": "Turn On",
        "date": "124689"
    },
    {
        "device-id": 150,
        "name": "Washer",
        "action": "Sleep",
        "date": "124533"
    },
]

var presentPage = 0;

function showPage() {
    // check if the form is submit or not

    let search = document.getElementById("search").value;
    var filter = search.toLowerCase();
    if (filter === "") {
        showItems(device_logs, false);
    } else {
        var devices = [];
        for (var i = 0; i < device_logs.length; i++) {
            if (device_logs[i].name.toLowerCase().indexOf(filter) > -1) {
                devices.push(device_logs[i])
            }
        }
        console.log(devices)
        showItems(devices, true);
    }

}


function showItems(items, search) {
    if (search) {
        var check = document.getElementsByClassName("button-container")[0];
        check.style.display = "none";

        presentPage = 0;
        createButton("search-button-container", items.length / 10);
        var table = document.getElementsByTagName("table")[0];
        var normal_tbody = document.getElementsByClassName("normal-table-container");
        console.log(normal_tbody)
        if (normal_tbody.length != 0) {
            table.removeChild(table.getElementsByTagName("tbody")[0])
        }      
        // add new rows
        addDataToTable(items, 10, search);
    } else {
        createButton("button-container", items.length / 20);
        addDataToTable(items, 20, search);
    }

}

function createButton(className, butt_num, search) {
    var check = document.getElementsByClassName(className);
    if (check.length == 0) {
        var div = document.createElement("div");
        if (search){
            div.classList.add("search-table-container")
        } else {
            div.classList.add("normal-table-container")
        }
        div.classList.add(className);
        for (var j = 0; j < butt_num; j++) {
            var butt = document.createElement("button");
            butt.classList.add("butt-num");
            butt.innerText = j + 1;
            butt.addEventListener("click", function () {
                presentPage = j;
            });

            div.appendChild(butt);
        }
        document.getElementById("table-display").appendChild(div);
    }
}
function addDataToTable(items, item_num) {
    var check = document.getElementsByTagName("tbody");
    if (check.length == 0) {
        var tbody_tag = document.createElement("tbody");
        var tr;
        for (var i = presentPage * item_num; (i < items.length && i < (presentPage + 1) * item_num); i++) {
            tr = tbody_tag.insertRow(-1);

            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = items[i]["device-id"];
            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = items[i]["name"];
            tabCell.classList.add("device-name")
            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = items[i]["action"];
            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = items[i]["date"];
        }
        console.log(tbody_tag)
        document.getElementById("table").appendChild(tbody_tag);
    } 
}